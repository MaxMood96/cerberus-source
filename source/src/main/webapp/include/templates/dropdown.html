<template id="dropdown-template">
    <div class="relative" @click.outside="close()">
        <!-- Label + boutons -->
        <div class="flex items-center justify-between mb-1">
            <label class="text-xs text-slate-400 dark:text-slate-500" x-text="label"></label>

            <!-- Boutons visibles seulement quand dropdown ouvert -->
            <div class="flex gap-2" x-show="open">
                <button type="button"
                        class="text-[10px] px-2 py-0.5 rounded dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600 bg-slate-200 text-slate-700 hover:bg-slate-300"
                        @click="selectAll()">All</button>
                <button type="button"
                        class="text-[10px] px-2 py-0.5 rounded dark:bg-slate-700 dark:text-slate-300 dark:hover:bg-slate-600 bg-slate-200 text-slate-700 hover:bg-slate-300"
                        @click="selectNone()">None</button>
            </div>
        </div>

        <!-- Bouton principal -->
        <button type="button"
                @click="toggleOpen()"
                class="flex h-10 items-center justify-between w-full rounded-md border px-3 py-2 text-sm
                       dark:bg-slate-800 dark:border-slate-600 dark:text-slate-300 dark:hover:bg-slate-700 bg-white border-slate-300 text-slate-900 hover:bg-slate-100 transition-all">
            <span x-text="selectedLabel()"></span>
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2"
                 fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
            </svg>
        </button>

        <!-- Dropdown -->
        <div x-show="open" x-transition
             class="absolute mt-1 w-full rounded-md border shadow-lg z-50
                    dark:bg-slate-800 dark:border-slate-600 dark:text-slate-300 bg-white border-slate-300 text-slate-900">
            <ul class="py-1 text-sm">
                <template x-for="item in items" :key="item">
                    <li>
                        <button type="button"
                                @click.stop="toggle(item)"
                                class="w-full flex items-center gap-2 px-3 py-2 dark:hover:bg-slate-700 hover:bg-slate-100 transition-colors">
                            <svg x-show="selected.includes(item)" xmlns="http://www.w3.org/2000/svg"
                                 class="h-3 w-3 text-blue-500" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M20 6 9 17l-5-5"></path>
                            </svg>
                            <span x-text="item"></span>
                        </button>
                    </li>
                </template>
            </ul>
        </div>
    </div>
</template>